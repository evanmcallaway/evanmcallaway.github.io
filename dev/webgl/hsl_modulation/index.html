<html>
  <head>
    <title>HSL Modulation with WebGL</title>
    <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
    <script src="/layout/load.js"></script>
    <script src="hsl.js"></script>
  </head>

  <script>
    function startCanvases() {
      webGLStart('canvas1', '/dev/webgl/hsl_modulation/colorful.jpg', { hue: true })
      webGLStart('canvas2', '/dev/webgl/hsl_modulation/crayons.jpg', { hue: true })

      webGLStart('canvas3', '/dev/webgl/hsl_modulation/colorful.jpg', { saturation: true })
      webGLStart('canvas4', '/dev/webgl/hsl_modulation/crayons.jpg', { saturation: true })

      webGLStart('canvas5', '/dev/webgl/hsl_modulation/colorful.jpg', { lightness: true })
      webGLStart('canvas6', '/dev/webgl/hsl_modulation/crayons.jpg', { lightness: true })
    }
  </script>

  <body onload="startCanvases()">
    <div class="container">
      <h3>HSL Modulation with WebGL</h3>

      <p>
        For these little prototypes I'm rendering couple of colorful images with WebGL and then I'm using a fragment shader to manipluate their color.  For this simple exercise I'm going to use HSL to perform the color manipulations because the implementation is extremely simple, but there's no reason you couldn't apply the same techniques to a more modern color modulation like HSB/HSV or LCH.
      </p>

      <h4>Hue</h4>
      <div class="center-content">
        <canvas id="canvas1" width=320 height=320></canvas>
        <canvas id="canvas2" width=320 height=320></canvas>
      </div>

      <h4>Saturation</h4>
      <div class="center-content">
        <canvas id="canvas3" width=320 height=320></canvas>
        <canvas id="canvas4" width=320 height=320></canvas>
      </div>

      <h4>Lightness</h4>
      <div class="center-content">
        <canvas id="canvas5" width=320 height=320></canvas>
        <canvas id="canvas6" width=320 height=320></canvas>
      </div>

      <div>
        HSL modulation done simply by converting our RGB color into HSL space, applying a small transform to the HSL color values, and then converting the color back to RGB space for display.

        <p>A couple of key notes on this:</p>
        <ul class="browser-default">
          <li>8-bit RGB is typically represented by a color cube with dimensions from 0-255.  Because vectors, WebGL uses a color cube with dimensions from 0-1, so we have to scale our color math proportionally.</li>
          <li>HSL is a cylindrical colorspace, with hue representing the angle along a circular cross-section, saturation is distance from the middle of a circular cross-section, and lightness is distance along the height of the cylinder.</li>
          <li>We can treat saturation and lightness as linear values and apply proportional transformations to manipulate them.  To avoid unpleasant jumps in our color manipulation animation, we'll reverse direction on our transformations.</li>
          <li>Hue manipulation is handled by increasing the "angle" of the color on the cylinder.  Note that because hue is traveling around a circle, we never need to reverse direction for a smooth animation -- once we've travelled fully around the circle we can just keep going.</li>
        </ul>
      </div>

      <p>
        You'll note that I'm not showcasing darkening with lightness modulation on this page.  HSL has some pretty gnarly edge cases that come out of darker colors being more saturated, so near-white dithered colors start to look a bit deep fried in some cases.  If you really need to modulate an image to be darker, I highly recommend using HSB/HSV instead.
      </p>

      <p>
        The source for his page is available <a href="https://github.com/evanmcallaway/evanmcallaway.github.io/tree/master/dev/webgl/hsl_modulation">here</a>.
      </p>

      <p>TODOs:</p>
      <ul class="browser-default">
        <li>Convert hsl.js into a module.</li>
        <li>Separate WebGL boilerplate from the meat of the project.</li>
        <li>Expand explanation text.</li>
        <li>Add colorspace diagrams for easier visualization.</li>
      </ul>
    </div>
  </body>
</html>